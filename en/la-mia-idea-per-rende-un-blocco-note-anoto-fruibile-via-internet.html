<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name=viewport content="width=device-width, initial-scale=1">
        <title>La mia idea per rende un blocco note Anoto fruibile via internet</title>
        <link rel="stylesheet" href="http://blog.gambuzzi.it/en/theme/css/main.css" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script src="http://blog.gambuzzi.it/en/theme/js/fuzzyset.js"></script>
		<meta name="google-site-verification" content="62DfkLCugSzm-vW0NRbnM2aCMcGu7uqfsXjED71GNbI" />
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-54060223-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
<script type="text/javascript">
  var _gauges = _gauges || [];
  (function() {
    var t   = document.createElement('script');
    t.type  = 'text/javascript';
    t.async = true;
    t.id    = 'gauges-tracker';
    t.setAttribute('data-site-id', '550ab326de2e26670a017635');
    t.setAttribute('data-track-path', 'https://track.gaug.es/track.gif');
    t.src = 'https://track.gaug.es/track.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(t, s);
  })();
</script>
</head>

<body id="index" class="home lang- 1.0.0">
        <header id="banner" class="body">
                <h1><a href="http://blog.gambuzzi.it/en/">Code's Fragment  <strong>and various amenities</strong></a></h1>

                <div class="langchange"><ul>
                        <li><a href="http://blog.gambuzzi.it"><img src="http://blog.gambuzzi.it/en/theme/images/it.png" alt="it"/></a></li>
                    <!-- separator -->
                    </ul>
                </div>

                <form id="headsearch" action='/search.html' method="GET">search: <input type="text" name="q" id="q0" /></form>

                <nav><ul>
                    <li><a href="http://blog.gambuzzi.it/en/category/mix.html">Mix</a></li>
                    <li><a href="http://blog.gambuzzi.it/en/category/php.html">Php</a></li>
                    <li><a href="http://blog.gambuzzi.it/en/category/python.html">Python</a></li>
                    <li><a href="http://blog.gambuzzi.it/en/category/windows.html">Windows</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="http://blog.gambuzzi.it/en/la-mia-idea-per-rende-un-blocco-note-anoto-fruibile-via-internet.html" rel="bookmark"
           title="Permalink a La mia idea per rende un blocco note Anoto fruibile via internet">La mia idea per rende un blocco note Anoto fruibile via internet</a></h1>
<a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="gbinside">Tweet</a><script type="text/javascript" src="//platform.twitter.com/widgets.js"></script>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2012-11-09T00:00:00">
                Pubblicato: 09 11 2012
        </abbr>

        <address class="vcard author">
                Da                         <a class="url fn" href="http://blog.gambuzzi.it/en/author/roberto-gambuzzi.html">Roberto Gambuzzi</a>
        </address>
<p>In <a href="http://blog.gambuzzi.it/en/category/anoto-digital-paper.html">Anoto Digital Paper</a>. </p>
<p>tags: <a href="http://blog.gambuzzi.it/en/tag/python.html">python</a> <a href="http://blog.gambuzzi.it/en/tag/anoto-digital-paper.html">anoto digital paper</a> </p>
</footer><!-- /.post-info -->      <p>La mia idea per rende il blocco note fruibile via internet sarebbe la seguente, se l’unico dato dinamico del blocco fosse l’indirizzo a cui andare a vederlo.</p>
<p>Calcolare l’indirizzo dal numero di pagina anoto (dato già univoco).</p>
<p>Ad esempio se l’url di base è <code>http://vostroserver/blocconote/&lt;codicefoglio&gt;</code></p>
<p>Il <code>&lt;codicefoglio&gt;</code> può essere una qualsiasi sequenza alfanumerica.</p>
<p>L’indirizzo anoto è di 40 bit</p>
<p><code>0.169.12.23.234</code></p>
<p><code>3 bit + 12 bit + 12bit + 5bit +8bit = 40bit</code></p>
<p>Possiamo usare 32 simboli su 8 posizioni, dato che 32 simboli sono 5 bit, 5x8 = 40bit. Con 64 simboli sarebbero quindi 6bit*7caratteri = 42 bit, quindi stiamo nei 40bit</p>
<p>L’indirizzo <code>0.169.12.23.234</code> diventa quindi</p>
<div class="highlight"><pre><span class="mi">0</span> <span class="o">=</span> <span class="mo">000</span>
<span class="mi">169</span> <span class="o">=</span> <span class="mo">000010101001</span>
<span class="mi">12</span> <span class="o">=</span> <span class="mo">000000001100</span>
<span class="mi">23</span> <span class="o">=</span> <span class="mi">10111</span>
<span class="mi">234</span> <span class="o">=</span> <span class="mi">11101010</span>
</pre></div>


<ul>
<li>In totale 0000000101010010000000011001011111101010</li>
<li>Come intero 5’670’803’434</li>
</ul>
<p>In binario, troppo lungo e difficile da scrivere e correggere se si sbaglia.</p>
<p>Con 32 simboli abbiamo 8 caratteri necessari, facili da scrivere e correggere.</p>
<div class="highlight"><pre><span class="n">AFJADF5K</span>
</pre></div>


<p>Con 64 diventa</p>
<div class="highlight"><pre><span class="n">AFSAZfq</span>
</pre></div>


<p>Che pero’ è meno facile da scrivere perché mischia maiuscolo e minuscolo, dando come unico vantaggio l’avere 7 caratteri invece di 8.</p>
<p>I file Postscript verrebbero creati in BATCHProcess e il codice aggiunto da un programma python che gira successivamente sui file PS.</p>
<p>In ricezione della pagina e creazione della immagine non è necessario rimettere tale codice a mio avviso, ma si può fare. Il nome dell’immagine può rimanere quello standard di anoto, che contiene l’indirizzo, e questo necessita che la pagina <code>php</code> di visualizzazione faccia i conti al contrario rispetto alla codifica, oppure posso salvare l’immagine con il nome calcolato. (nel primo caso non serve postprocesso dell’immagine ricevuta, nel secondo si)</p>
<p>Dato che così si verrebbero a creare dei codici consecutivi (AFJADF5K sarebbe seguito da AFJADF5L) per evitare che si possano indovinare cosi facilmente i codici di pagina si può inserire in coda alla stringa una specie di codice di controllo calcolato in un qualche modo. Ad esempio AFJADF5K diverrebbe AFJADF5KJ e AFJADF5L diverrebbe AFJADF5LO. Abbiamo aggiunto 1 carattere e un po’ di sicurezza. Ovviamente un attacco in brute-force che le provi tutte riuscirebbe ad avere  la meglio su questa piccola protezione.</p>
<p>Per avere una sicurezza maggiore si dovrebbe allungare il codice diluendo quindi i risultati validi e impostando un IP-ban temporaneo se vengono fatte troppe richieste errate di fila.
Per aumentare ulteriormente la sicurezza si potrebbe associare una password casuale ad ogni blocco note, scrivendola sulla copertina.</p>
<p>Nel DB del web server si salva gamma-di-indirizzi e la password</p>
<table>
<thead>
<tr>
<th>ADDR</th>
<th>PASSWD</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.169.12.23.*</td>
<td>xxxxxxxxxx</td>
</tr>
</tbody>
</table>
<p>Il web server prima di visualizzare la pagina chiede la password e la salva da qualche parte(così se uno controlla più pagine dello stesso blocco note non lo molesta chiedendo la password ogni foglio)</p>
<p>In alternativa si potrebbe (per non avere sempre blocchi da 256 pagine):</p>
<table>
<thead>
<tr>
<th>DA</th>
<th>A</th>
<th>PASSWD</th>
</tr>
</thead>
<tbody>
<tr>
<td>AFJADFYA</td>
<td>AFJADF55</td>
<td>xxxxxxxxxx</td>
</tr>
</tbody>
</table>
<p>I codici sopra riportati sono stati creati così</p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">string</span>

<span class="k">def</span> <span class="nf">int2bin</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">24</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">((</span><span class="n">n</span> <span class="o">&gt;&gt;</span> <span class="n">y</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)])</span>

<span class="k">def</span> <span class="nf">code</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">cifre</span><span class="p">,</span><span class="n">ncifre</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">lc</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cifre</span><span class="p">)</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="k">while</span> <span class="n">n</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">if</span> <span class="n">ncifre</span><span class="o">&lt;</span><span class="mi">0</span> <span class="k">else</span> <span class="n">ncifre</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">ret</span><span class="o">=</span> <span class="n">cifre</span><span class="p">[</span><span class="n">n</span> <span class="o">%</span> <span class="n">lc</span><span class="p">]</span><span class="o">+</span><span class="n">ret</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="n">lc</span><span class="p">)</span>
        <span class="n">ncifre</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">ret</span>

<span class="k">def</span> <span class="nf">crc</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">cifre</span><span class="p">):</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span>
        <span class="n">ret</span> <span class="o">^=</span> <span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cifre</span><span class="p">[</span><span class="n">ret</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">cifre</span><span class="p">)]</span>

<span class="n">bits</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">indirizzo</span> <span class="o">=</span> <span class="s">&#39;0.169.12.23.234&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">indirizzo</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">+=</span> <span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">bits</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="o">&lt;&lt;</span><span class="nb">sum</span><span class="p">(</span><span class="n">bits</span><span class="p">[:</span><span class="n">i</span><span class="p">]))</span>

<span class="k">print</span> <span class="n">n</span>    
<span class="k">print</span> <span class="n">int2bin</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">40</span><span class="p">)</span>

<span class="n">cod</span> <span class="o">=</span> <span class="n">code</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">[:</span><span class="mi">6</span><span class="p">],</span> <span class="mi">8</span><span class="p">)</span>
<span class="k">print</span> <span class="n">cod</span>
<span class="k">print</span> <span class="n">code</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span> <span class="o">+</span> <span class="s">&#39;+/&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="k">print</span> <span class="n">crc</span><span class="p">(</span> <span class="n">cod</span><span class="p">,</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">[:</span><span class="mi">6</span><span class="p">])</span>
</pre></div>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://martinfowler.com/">Martin Fowler</a></li>
                            <li><a href="http://www.joelonsoftware.com/">Joel On Software</a></li>
                            <li><a href="http://alanstorm.com/">Alan Storm</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="https://twitter.com/gbinside">Twitter</a></li>
                            <li><a href="https://github.com/gbinside">GitHub</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                &nbsp;
                </address><!-- /#about -->

                <p>&nbsp;</p>
        </footer><!-- /#contentinfo -->

<script type="text/javascript">
    var disqus_config = function () {
      this.language = "it";
    };
    var disqus_shortname = 'bloggambuzzi';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>